'use strict';(function(){Polymer({is:'sd-keen-vis',properties:{counterValue:{type:Number,value:0,notify:true},project:{type:String},readKey:{type:String},collection:{type:String},targetProperty:{type:String},groupBy:{type:Array,value:function value(){return[]}},filters:{type:Array,value:function value(){return[]}},analysisType:{type:String},timeframe:{type:String},interval:{type:String},yTitle:{type:String,value:'Hello'},chartYTitle:{type:String,value:'',notify:true,readOnly:true},chartData:{type:Object,notify:true,reflectToAttribute:true,value:function value(){return{}},readOnly:true}},observers:['_initClient(project, key)','_updateQuery(collection, analysisType)'],created:function created(){this.chartConfig={seriesConfig:{}}},attached:function attached(){console.log('attached');this._configureChart();this._updateQuery()},_initClient:function _initClient(){console.log('initClient');this.client=new Keen({projectId:this.project,readKey:this.readKey});this._updateQuery()},_configureChart:function _configureChart(){this._setChartYTitle({'title':this.yTitle,'titleTruncation':false})},_updateQuery:function _updateQuery(){if(!this.client){this._initClient()}else{Keen.ready(function(){this.query=new Keen.Query(this.analysisType,{event_collection:this.collection,timeframe:this.timeframe,targetProperty:this.targetProperty,interval:this.interval,groupBy:this.group,filters:this.filters});console.log(this.query);this._runQuery()}.bind(this))}},_runQuery:function _runQuery(){if(this.client){this.client.run(this.query,function(err,res){if(err){console.log(err)}else{console.log(res.result);var result=res.result;result=_.map(result,function(n){n={'x':parseInt(moment(n.timeframe.end).format('x')),'y':n.value};return n});this._setChartData(result)}}.bind(this))}},handleClick:function handleClick(event,detail,sender){this.increment()},increment:function increment(){this.counterValue++}})})();
//# sourceMappingURL=sd-keen-vis.js.map
